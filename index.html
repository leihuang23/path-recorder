<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Drawing Path Recorder</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      h1 {
        margin-bottom: 10px;
      }

      .canvas-container {
        position: relative;
        margin: 20px 0;
        border: 2px solid #333;
      }

      canvas {
        display: block;
        background-color: #f8f8f8;
        cursor: crosshair;
      }

      .controls {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }

      button {
        padding: 8px 16px;
        background-color: #4285f4;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
      }

      button:hover {
        background-color: #3367d6;
      }

      button:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }

      .status {
        font-size: 14px;
        color: #666;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <h1>Drawing Path Recorder</h1>

    <div class="controls">
      <button id="startBtn">Start Drawing</button>
      <button id="clearBtn">Clear Canvas</button>
      <button id="getPathBtn">Get Path Coordinates</button>
    </div>

    <div class="canvas-container">
      <canvas id="drawingCanvas" width="600" height="400"></canvas>
    </div>

    <div class="status" id="status">
      Ready to draw. Click "Start Drawing" to begin.
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const canvas = document.getElementById("drawingCanvas");
        const ctx = canvas.getContext("2d");
        const startBtn = document.getElementById("startBtn");
        const clearBtn = document.getElementById("clearBtn");
        const getPathBtn = document.getElementById("getPathBtn");
        const statusElem = document.getElementById("status");

        let isDrawing = false;
        let isRecording = false;
        let pathCoordinates = [];

        // Initialize canvas
        ctx.lineWidth = 3;
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
        ctx.strokeStyle = "#000000";

        // Start drawing button
        startBtn.addEventListener("click", function () {
          if (!isRecording) {
            isRecording = true;
            pathCoordinates = [];
            startBtn.textContent = "Stop Drawing";
            statusElem.textContent = "Recording your drawing...";
          } else {
            isRecording = false;
            startBtn.textContent = "Start Drawing";
            statusElem.textContent = `Drawing completed! Recorded ${pathCoordinates.length} points.`;
          }
        });

        // Clear canvas button
        clearBtn.addEventListener("click", function () {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          pathCoordinates = [];
          isRecording = false;
          startBtn.textContent = "Start Drawing";
          statusElem.textContent = "Canvas cleared. Ready to draw.";
        });

        // Get path coordinates button
        getPathBtn.addEventListener("click", function () {
          if (pathCoordinates.length > 0) {
            const strData = JSON.stringify(pathCoordinates);
            console.log(strData);
            navigator.clipboard
              .writeText(strData)
              .then(() => {
                console.log("Path coordinates copied to clipboard!");
                statusElem.textContent = `Path coordinates copied to clipboard! Total points: ${pathCoordinates.length}`;
              })
              .catch((err) => {
                console.error("Failed to copy: ", err);
                statusElem.textContent = "Failed to copy path coordinates.";
              });
          } else {
            statusElem.textContent = "No drawing recorded yet.";
          }
        });

        // Mouse events for drawing
        canvas.addEventListener("mousedown", startDrawing);
        canvas.addEventListener("mousemove", draw);
        canvas.addEventListener("mouseup", stopDrawing);
        canvas.addEventListener("mouseout", stopDrawing);

        // Touch events for mobile devices
        canvas.addEventListener("touchstart", handleTouchStart);
        canvas.addEventListener("touchmove", handleTouchMove);
        canvas.addEventListener("touchend", handleTouchEnd);

        function startDrawing(e) {
          if (!isRecording) return;

          isDrawing = true;
          const pos = getPosition(e);

          // Start a new path
          ctx.beginPath();
          ctx.moveTo(pos.x, pos.y);

          // Record the starting position
          pathCoordinates.push([Math.round(pos.x), Math.round(pos.y)]);
        }

        function draw(e) {
          if (!isDrawing || !isRecording) return;

          const pos = getPosition(e);

          // Draw line to the new position
          ctx.lineTo(pos.x, pos.y);
          ctx.stroke();

          // Record the position
          pathCoordinates.push([Math.round(pos.x), Math.round(pos.y)]);
        }

        function stopDrawing() {
          isDrawing = false;
        }

        function getPosition(e) {
          const rect = canvas.getBoundingClientRect();
          return {
            x: e.clientX - rect.left,
            y: e.clientY - rect.top,
          };
        }

        function handleTouchStart(e) {
          e.preventDefault();
          if (e.touches.length === 1) {
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent("mousedown", {
              clientX: touch.clientX,
              clientY: touch.clientY,
            });
            canvas.dispatchEvent(mouseEvent);
          }
        }

        function handleTouchMove(e) {
          e.preventDefault();
          if (e.touches.length === 1) {
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent("mousemove", {
              clientX: touch.clientX,
              clientY: touch.clientY,
            });
            canvas.dispatchEvent(mouseEvent);
          }
        }

        function handleTouchEnd(e) {
          e.preventDefault();
          const mouseEvent = new MouseEvent("mouseup");
          canvas.dispatchEvent(mouseEvent);
        }
      });
    </script>
  </body>
</html>
